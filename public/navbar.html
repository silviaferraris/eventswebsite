<script>
    $("#ftco-navbar").hide();
    $("#navbarDropdownMenuLink").hide();

    fetch('/user').then(async response =>
    {
        if(response.status === 401) return;

        let body = await response.json();

        $("#nav-login-btn").hide();
        $("#navbarDropdownMenuLink").show();

        let avatar = body.avatar;
        let username = body.username;
        let name = body.name;
        let surname = body.surname;
        let email = body.email;

        $("#navbarDropdownMenuLink img").attr('src', `/assets/images/default-avatars/avatar${avatar}.png`);
        $("#drop-down-avatar").attr('src', `/assets/images/default-avatars/avatar${avatar}.png`);
        $("#navbarDropdownMenuLink span").text(username);
        $("#drop-down-name-and-surname").text(`${name} ${surname}`);
        $("#drop-down-email").text(email);


    }).finally(() => {

        let path = window.location.pathname;
        $('#nav-links a[href="'+path+'"]').parent().addClass('active');

        if(path.startsWith('/login') || path.startsWith('/signup'))
        {
            $("#nav-login-btn").hide();
            $("#navbarDropdownMenuLink").hide();
        }

        $("#ftco-navbar").show();

    });

</script>

<nav class="navbar navbar-expand-lg navbar-dark ftco_navbar bg-dark ftco-navbar-light" id="ftco-navbar">

    <a class="navbar-brand" href="#"><span class="flaticon-lotus"></span>Silvia's Website</a>

    <button class="navbar-toggler collapsed" type="button" data-toggle="collapse" data-target="#ftco-nav" aria-controls="ftco-nav" aria-expanded="false" aria-label="Toggle navigation">
        <span class="navbar-toggler-icon"></span>
    </button>

    <div class="navbar-collapse collapse" id="ftco-nav">
        <ul class="navbar-nav" id="nav-links">
            <li class="nav-item"><a href="/" class="nav-link">Home</a></li>
            <li class="nav-item"><a href="/faq/" class="nav-link">FAQ</a></li>
            <li class="nav-item"><a href="/contactus/" class="nav-link">Contact me</a></li>
        </ul>
        <ul class="navbar-nav ml-auto">
            <li class="nav-item dropdown" style="padding-right: 20px; max-height: 50px;">
                <a class="nav-link dropdown-toggle" href="#" id="navbarDropdownMenuLink" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">
                    <img src="" width="35" height="35" style="display: inline-block" alt="avatar"/><span style="padding-left: 10px"></span>
                </a>
                <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdownMenuLink">

                    <div>
                        <div class="avatar-div"><img src="" alt="avatar" width="100" height="100" id="drop-down-avatar"></div>
                        <div class="user-data-div">
                            <span id="drop-down-name-and-surname" style="font-weight: bold"></span><br>
                            <span id="drop-down-email" style="font-size: smaller"></span><br>
                            <a class="btn btn-sm btn-outline-secondary" href="#" style="margin-top: 10px">Edit profile</a>
                        </div>
                    </div>

                    <a class="dropdown-item" href="#"><img src="/assets/images/menu-icons/cart-icon.png" width="24" height="24"><span style="padding-left: 10px">My Cart</span></a>
                    <a class="dropdown-item" href="/logout"><img src="/assets/images/menu-icons/logout-icon.png" width="24" height="24"><span style="padding-left: 10px">Logout</span></a>
                </div>
            </li>
            <!--<button class="btn btn-outline-success" type="button" onclick="location.href='/login'" id="nav-login-btn">Login / Sign up</button>-->
            <a class="btn" href="/login" type="button" id="nav-login-btn" target="_blank">login or signup</a>
        </ul>
    </div>

</nav>