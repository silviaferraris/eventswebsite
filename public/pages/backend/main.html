<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="" xml:lang="">
<head>
  <meta charset="utf-8" />
  <meta name="generator" content="pandoc" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />
  <title>Backend Documentation</title>
  <style>

    /*body{
      padding-left: 30px;
      padding-right: 30px;
    }

    #main-title{
      color: #232323;
      font-size: 44px;
    }

    .subtitle{
      display: inline-block;
      color: #232323;
      font-size: 26px;
      font-weight: bold;
      margin-top: 40px;
      margin-bottom: 10px;
    }

    #group-info-table {
      font-family: sans-serif;
      border-collapse: collapse;
      width: 100%;
    }

    #group-info-table td, #group-info-table th {
      border: 1px solid #ddd;
      padding: 8px;
      text-align: center;
    }

    #group-info-table tr:hover {
      background-color: #ddd;
    }

    #group-info-table th {
      padding-top: 12px;
      padding-bottom: 12px;
      background-color: rgba(0, 30, 175, 0.31);
      color: white;
    }

    .list-item{
      margin: 6px;
      font-size: 18px;
      color: #232323;
    }

    .list-item strong{
      display: inline-block;
      min-width: 180px;
    }

    .specification-list{
      list-style-type: none;
    }

    .specification-list li{
      margin-top: 6px;
      margin-bottom: 6px;
    }

    .specification-list li p{
      font-size: 18px;
    }

    .db{
      width: 400px;
      height: 800px;
    }*/

  </style>


  <style>

    body{
      background-color: #f3f3f3;
    }

    *{
      font-family: "Roboto Thin", sans-serif;
      color: #464646;
    }

    .page-container{
      position: relative;
      max-width: 1200px;
      margin: auto;
      padding: 10px;
      background-color: #ffffff;
      box-shadow: 0 4px 7px 0 rgba(0, 0, 0, 0.60);
    }

    #main-title{
      font-size: 40px;
      letter-spacing: 2px;
      text-align: left;
      margin-bottom: 15px;
    }

    .document-section{
      width: 100%;
      margin-top: 20px;
      margin-bottom: 5px;
    }

    .section-title{
      font-size: 28px;
      letter-spacing: 2px;
      color: #232323;
      margin-top: 15px;
      margin-bottom: 0;
    }

    .section-subtitle{
      font-size: 20px;
      letter-spacing: 2px;
      color: #232323;
      margin-top: 15px;
      margin-bottom: 4px;
    }
    .section-subtitle-big{
      font-size: 24px;
      letter-spacing: 2px;
      color: #232323;
      margin-top: 15px;
      margin-bottom: 4px;
    }
    table{
      text-align: left;
      border-collapse: collapse;
      border-color: #4b4b4b;
      width: calc(100% - 40px);
      margin-left: 20px;
      margin-right: 20px;
    }
    table tr{
      height: 60px;
    }
    table tr th, table tr td{
      border-top: 1px solid #e9e9e9;
      padding-left: 10px;
      padding-right: 10px;
      font-size: 16px;
      color: #6e6e6e;
      font-weight: normal;
      letter-spacing: 1px;
    }

    ul li{
      margin-bottom: 5px;
      margin-top: 5px;
      font-family: Verdana, Geneva, sans-serif
    }

    p{
      margin-top: 0;
      margin-bottom: 25px;
      font-size: 16px;
      font-family: Verdana, Geneva, sans-serif
    }

    a{
      font-family: Verdana, Geneva, sans-serif
    }


    #database-diagram{
      margin-top: 20px;
      width: 100%;
    }

    .deliverables-links{
      width: 100%;
      padding-left: 8px;
      display: grid;
      grid-template-columns: max-content auto;
      grid-column-gap: 6px;
      grid-row-gap: 5px;
    }

  </style>

</head>
<body>

  <div class="page-container">
    <div id="main-title">DOCUMENTATION OF THE BACKEND PART</div>

    <section class="document-section">
      <div class="section-title">GENERAL GROUP INFORMATION</div>
      <table>
        <tr>
          <th>MEMBER N.</th>
          <th>ROLE</th>
          <th>FIRST NAME</th>
          <th>LAST NAME</th>
          <th>MATRICOLA</th>
          <th>EMAIL ADDRESS</th>
        </tr>
        <tr>
          <td>1</td>
          <td>Administrator</td>
          <td>Silvia</td>
          <td>Ferraris</td>
          <td>854767</td>
          <td>silvia1.ferraris@mail.polimi.it</td>
        </tr>
      </table>
    </section>

    <section class="document-section">
      <div class="section-title">LINKS TO OTHER DELIVERABLES</div>
      <div class="deliverables-links">
        <span>Web App (D0):</span><a href="https://silviaferrariswebsite.herokuapp.com/"> https://silviaferrariswebsite.herokuapp.com/</a>
        <span>Yaml file (D2):</span><a href="https://silviaferrariswebsite.herokuapp.com/backend/spec.yaml"> https://silviaferrariswebsite.herokuapp.com/backend/spec.yaml</a>
        <span>Swagger UI (D3):</span><a href="https://silviaferrariswebsite.herokuapp.com/backend/swaggerui/"> https://silviaferrariswebsite.herokuapp.com/backend/swaggerui/</a>
        <span>App source code (D4):</span><a href="https://silviaferrariswebsite.herokuapp.com/backend/app.zip"> https://silviaferrariswebsite.herokuapp.com/backend/app.zip</a>
        <span>Repository (D5):</span><a href="https://github.com/silviaferraris/eventswebsite"> https://github.com/silviaferraris/eventswebsite</a>
      </div>
    </section>

    <section class="document-section">
      <div class="section-title">SPECIFICATION</div>
      <div class="section-subtitle-big">WEB ARCHITECTURE</div>
      <div class="section-subtitle">PRESENTATION LAYER</div>
      <p>
        The we application contains both static and dynamic pages.<br>
        Both are provided statically by the server, but the dynamic ones, contains javascript code, which through requests to the server, receives the data in JSON format and render the dynamic contents of the page.<br>
        To ensure that no pages can be rendered on the server side, all APIs respond only in JSON format or provide HTML page files statically.
      </p>
      <div class="section-subtitle">APPLICATION LAYER</div>
      <p>
        There are two main groups of APIs:<br>
        Those within the "/admin/*" path that are accessible only by administrator users and contain all the functions for the operation of the dashboard, capable of modifying the data of events, seminars and performers within the database.<br>
        The others, accessible to any user and are organized in:</p>
        <ul>
          <li>"/user/*": which contain all the functions useful for registered users, as well as the functions for registering a new user, login in and logout</li>
          <li>"/user/cart/*": they are a subcategory of the former, and contain the functions for the management of the cart by the user</li>
          <li>"/events/*": are the APIs that return all the data relating to the events</li>
          <li>"/seminars/*": are the APIs that return all the data relating to the seminars</li>
          <li>"/performers/*": are the APIs that return all the data relating to the performers</li>
        </ul>
      <p>The server is connected to a relational database (PostgresSQL) and uses the knex module to generate SQL queries.</p>

      <div class="section-subtitle">DATA LAYER</div>
      <p>Application data management takes place through the use of a relational database (PostgresSQL) that is integrated in Heroku, the platform that host the application.</p>

      <div class="section-subtitle-big">API</div>
      <div class="section-subtitle">REST PRINCIPLES</div>
      <p>
        The application APIs follow all REST principles as much as possible.<br>
        The client is completely independent from the server, and can request resources using unique URL for each resource.<br>
        The requests are all stateless, and almost all are cacheable.<br>
        The URLs of all APIs are organized on levels: For example, all the APIs that provide resources for events have the "events/*" URL, while those for managing the user and his cart have the "user/*" and "user/cart/*" URLs.
      </p>
      <div class="section-subtitle">OPENAPI RESOURCE MODELS</div>
      <p>
        I've introduced the following models: Event, Seminar, Performer, User. <br>
        Each model contains all the information about the relative object.<br>
        In details:
      </p>
      <ul>
        <li><strong>Event</strong> (id, title, description, date, performer_id, price, uuid, location, images_number, cover_image)</li>
        <li><strong>Seminar</strong> (id, title, description, date, performer_id, uuid, location, images_number, cover_image)</li>
        <li><strong>Performer</strong> (id, first_name, last_name, biography, photo, uuid)</li>
        <li><strong>User</strong> (username, first_name, last_name, email, birthday, avatar, admin)</li>
      </ul>
      <div class="section-subtitle-big">DATA MODEL</div>
      <img alt="Database diagram" id="database-diagram" src="/assets/images/doc/database-diagram-new.svg">
      <p>
        The OpenApi resource models reflects the structure of the main database tables.<br>
        The events and seminars tables both have one associated table each (EventsImages and SeminarsImages) which contain all the images (except the cover image that is directly in the main tables) saved with Base64 encoding.<br>
        The events and seminars tables are also linked by the EventsSeminars table which associates the related seminars with each event.<br>
        The performers table contains the data of all available performers, and associates them, through the performer_id, with the events and seminars tables.<br>
        Finally, the UsersEvents table contains the cart data of all users.
        <br>
        <br>
        The database contains also two materialized view (eventsPerformerView and seminarsPerformerView) that add to the Events and Seminars table the performer fist name and last name for optimize some queries.
      </p>
    </section>

    <section class="document-section">
      <div class="section-title">IMPLEMENTATION</div>
      <div class="section-subtitle-big">TOOLS USED</div>
      <p>To implement the backend of the application I used javascript with the Node.js framework.<br>
        In details I used the modules:
      </p>
      <ul>
        <li><strong>Express:</strong> for create and managing the routes of all APIs</li>
        <li><strong>Passport:</strong> to manage the authentication of the users during the login</li>
        <li><strong>Express Session:</strong> to create the session for the logged users</li>
        <li><strong>Knex:</strong> for establish the connection with the database e for create and send the query to it.</li>
      </ul>
      <p>
        In order to access and manage the PostgresSQL database, I used the pgAdmin application.<br>
        Finally I used the swaggerUi module to generate the documentation from the yaml file.
      </p>
      <div class="section-subtitle-big">DISCUSSION</div>
      <ul>

        <li>
          <strong>How did you make sure your web application adheres to the provided OpenAPI specification? Which method did you use to test all APIs endpoints against the expected response?</strong>
          <p>I documented all the APIs using <a href="http://editor.swagger.io/">OpenApi Swagger Editor</a><br>
            I tested the APIs with the test that I've included in the swagger UI documentation, and with the <a href="https://www.postman.com/">Postman</a> application
          </p>
        </li>

        <li>
          <strong>Why do you think your web application adheres to common practices to partition a REST-based web application (static assets vs. application data)?</strong>
          <p>
            I think my web application adheres to common practices to partition a REST-based web application because all the APIs endpoints are responding to a specific resource with JSON formatted data, while the all the static resource all served from the public folder by a function of the express module.
          </p>
        </li>

        <li>
          <strong>Describe synthetically why and how did you manage session state, what are the state change triggering actions (e.g., POST to login etc..).</strong>
          <p>The session are managed by the Express Session module that create a temporary cookie on the browser of each logged user.<br>
            By default the session cookie expires when the client close the browser, but the client can request to the login API to create a cookie that not expires when the browser is closed.<br>
            The endpoints that trigger a state change are: the POST endpoint "/user/login" when the session is created and the GET endpoint "/user/logout" when the session is destroyed.
          </p>
        </li>

        <li>
          <strong>Which technology did you use (relational or a no-SQL database) for managing the data model?</strong>
          <p>I used the relational database PostgresSQL, and for managing the data model I used mainly pgAdmin application.<br>
            In order to insert new events, seminars and performers data to the database I develop a dashboard on my web application that use the "/admin/*" endpoints APIs to modify the content of the Events, Seminars and Performers table of my database.
          </p>
        </li>

      </ul>
    </section>

    <section class="document-section">
      <div class="section-title">OTHER INFORMATION</div>
      <div class="section-subtitle">TASK ASSIGNMENT</div>
      <p>I developed this web application alone, so I created all the backend, frontend and the documentation</p>
      <div class="section-subtitle">ANALYSIS OF EXISTING API</div>
      <p>I improved my knowledge about RESTFUL API principles and I took inspiration from the videos of the following website:
        <a href="https://thecodingtrain.com/Courses/data-and-apis/">https://thecodingtrain.com/Courses/data-and-apis/</a> which contains the best practices around how to plan, design, build, manage the APIs<br>
      I actually didn't take inspiration from any other existing APIS.</p>
      <div class="section-subtitle">LEARNING OUTCOME</div>
      <p>From this project I learned to use Node.js, the modules EXPRESS, KNEX, PASSPORT in order to manage the authentication. I also
      learned to produce the documentation of the API with OPENAPI SWAGGER. <br>
      I improved my coding skills with Javascript.<br>
      Thanks to this part of the project, and the whole project in general, I decided to implement the Website of
      my family business.</p>
    </section>

  </div>

</body>
</html>
