<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Events</title>

    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="/assets/css/style-new.css">

    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="/assets/js/navbar_and_footer_loader.js"></script>
    <script src="/assets/js/utils.js"></script>

    <script type="module">
        import Event from "../../assets/js/modules/event.mjs";
        let eventId = getCookieValue('eveid');
        let event = new Event(eventId);
        let slideCount;
        let currentSlide = 0;

        event.fetchData().then(data =>
        {
            $('#event-title').text(event.title);
            $('.banner-bg').css('background-image', `url("${event.coverImage}")`);
            $('#performer-title').text(`${event.performerFirstName} ${event.performerLastName}`);
            $('#performer-link').attr('href', `/performers/${event.performerId}`);
            $('#description').text(event.description);
            $('#eventprice').text(event.price);
            event.getImages('all').then(imgs=>
            {
                slideCount = imgs.length;
                for(let i=0; i<imgs.length;i++)
                {
                    let img=imgs[i];
                    let slide= $(`<li class="slide" id="slide${i}">
                                   <img src="${img.image}">
                                  </li>`);

                    $('.slideshow .slide-list').append(slide);
                    $(`#slide${0}`).css('left', '0');
                }

                $(document).on('click', '.slideshow .next-slide', () => slide(1));
                $(document).on('click', '.slideshow .prev-slide', () => slide(-1));

            })
        });

        function slide(x) {

            if(slide.lock1 || slide.lock2)return;

            slide.lock1 = true;
            slide.lock2 = true;

            let current = $(`#slide${currentSlide}`);

            currentSlide += x;
            if(currentSlide >= slideCount)currentSlide = 0;
            if(currentSlide < 0)currentSlide = slideCount-1;

            let next = $(`#slide${currentSlide}`);

            let width = current.outerWidth();

            current.animate({
                left: -width*x
            }, 400, () =>
            {
                current.css('left', '100%');
                slide.lock1 = false
            });

            if(x > 0)
            {
                next.animate({
                    left: 0
                }, 400, () => slide.lock2 = false);
            }
            else
            {
                next.css('left', 'auto').css('right', '100%').animate({
                    right: 0
                }, 400, () => slide.lock2 = false);
            }
        }

    </script>
</head>
<body>

<header></header>

<div class="banner" style="background-color: #FFF8E1">
    <div class="banner-bg"></div>
    <div class="headline" style="background-color: transparent">
    </div>
</div>
<div class="container-event">
    <main class="event-container">
    <div class="event-left-column">

        <div class="slideshow">
            <ul class="slide-list">

            </ul>
            <a class="next-slide">&gt;</a>
            <a class="prev-slide">&lt;</a>
        </div>

    </div>
<div class="event-right-column">
    <div class="event-description">
        <a id="performer-link"><span id="performer-title"></span></a>
        <span style="color: black" id="event-title"></span>
        <p id="description"></p>
    </div>
    <div class="event-price">
        <span id="eventprice"></span>
        <a href="#" class="cart-btn">BUY</a>
    </div>
</div>
    </main>
    <div class="correlated">
        <div class="seminar">
            <span>CORRELATED SEMINARS</span>
            <ul>
                <li class="seminar-card">
                    <div class="seminar-img">
                        <img src="/assets/images/backgrounds/wallpaper.jpg">
                    </div>
                    <div class="seminar-description">
                        <h2>Seminar Title</h2>
                        <span>
                            sjcfvfjnvfjnvjfv
                        </span>
                    </div>
                </li>
                <li class="seminar-card">
                    <div class="seminar-img">
                        <img src="/assets/images/backgrounds/shoppingcart-bg.jpg">
                    </div>
                    <div class="seminar-description">
                        <h2>Seminar Title</h2>
                        <span>
                            sjcfvfjnvfjnvjfv
                        </span>
                    </div>
                </li>
            </ul>
        </div>
    </div>
</div>
<footer></footer>
<div class="mobile-nav"></div>

</body>
</html>