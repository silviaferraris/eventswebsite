<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Performers</title>
    <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">

    <link rel="stylesheet" href="/assets/css/style-new.css">

    <script src="https://code.jquery.com/jquery-3.3.1.min.js"></script>
    <script src="/assets/js/navbar_and_footer_loader.js"></script>
    <script src="/assets/js/utils.js"></script>
    <script type="module" src="/assets/js/performers.js"></script>


    <script type="module">
        import Performer from "../../assets/js/modules/performer.mjs";
        let _performerId = getCookieValue('perid');
        let performer = new Performer(_performerId);
        let slideCount;
        let currentSlide = 0;
        performer.fetchData().then(data =>
        {
            $('#performer-title').text(`${performer.performerFirstName} ${performer.performerLastName}`);
            $('.banner-bg').css('background-image', `url("${performer.photo}")`);
            $('#performerbiography').text(performer.biography);
            performer.getImages('all').then(imgs=>
            {
                slideCount = imgs.length;
                for(let i=0; i<imgs.length;i++)
                {
                    let img=imgs[i];
                    let slide= $(`<li class="slide" id="slide${i}">
                                   <img src="${img.image}">
                                  </li>`);

                    $('.slideshow .slide-list').append(slide);
                    $(`#slide${0}`).css('left', '0');
                }

                $(document).on('click', '.slideshow .next-slide', () => slide(1));
                $(document).on('click', '.slideshow .prev-slide', () => slide(-1));

            })
        });

        function slide(x) {

            if(slide.lock1 || slide.lock2)return;

            slide.lock1 = true;
            slide.lock2 = true;

            let current = $(`#slide${currentSlide}`);

            currentSlide += x;
            if(currentSlide >= slideCount)currentSlide = 0;
            if(currentSlide < 0)currentSlide = slideCount-1;

            let next = $(`#slide${currentSlide}`);

            let width = current.outerWidth();

            current.animate({
                left: -width*x
            }, 400, () =>
            {
                current.css('left', '100%');
                slide.lock1 = false
            });

            if(x > 0)
            {
                next.animate({
                    left: 0
                }, 400, () => slide.lock2 = false);
            }
            else
            {
                next.css('left', 'auto').css('right', '100%').animate({
                    right: 0
                }, 400, () => slide.lock2 = false);
            }
        }
    </script>

</head>
<body>

<header></header>

<div class="banner" style="background-color: #FFF8E1">
    <div class="banner-bg" style="background-image: url('/assets/images/backgrounds/wallpaper.jpg')"></div>
    <div class="headline" style="background-color: transparent">
        <span style="color: #FFFFFF" id="performer-title"></span>
    </div>
</div>
<div class="container-event">
    <main class="event-container">
        <div class="event-left-column">

            <div class="slideshow">
                <ul class="slide-list">

                </ul>
                <a class="next-slide">&gt;</a>
                <a class="prev-slide">&lt;</a>
            </div>

        </div>
        <div class="event-right-column">
            <div class="performer-biography">
                <span style="color: black" id="performer-title"></span>
                <p id="performerbiography"></p>
            </div>
        </div>
    </main>

</div>


<footer></footer>
<div class="mobile-nav"></div>

</body>
